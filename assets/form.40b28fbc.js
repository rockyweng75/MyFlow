import{a3 as c,_ as N,a4 as u,f as O,u as y,g as L,L as B,h as q,r as d,o as m,c as T,A as P,j as w,w as l,l as x,a,F as b,z as k,t as z,a7 as j,B as J,d as A}from"./index.a74f1f35.js";const M=c(()=>u(()=>import("./stage.1948bce3.js"),["assets/stage.1948bce3.js","assets/index.a74f1f35.js","assets/index.1ce94655.css"])),G=c(()=>u(()=>import("./stageRouteView.6b02cb34.js"),["assets/stageRouteView.6b02cb34.js","assets/index.a74f1f35.js","assets/index.1ce94655.css","assets/actionType.ee836276.js"])),H=c(()=>u(()=>import("./validationView.d993ec2c.js"),["assets/validationView.d993ec2c.js","assets/index.a74f1f35.js","assets/index.1ce94655.css"])),K=c(()=>u(()=>import("./actionFormView.d02fb7c3.js"),["assets/actionFormView.d02fb7c3.js","assets/index.a74f1f35.js","assets/index.1ce94655.css","assets/actionType.ee836276.js"])),Q=c(()=>u(()=>import("./flowType.66ee9414.js"),["assets/flowType.66ee9414.js","assets/index.a74f1f35.js","assets/index.1ce94655.css"])),W=c(()=>u(()=>import("./tag.d23e29d3.js"),["assets/tag.d23e29d3.js","assets/index.a74f1f35.js","assets/index.1ce94655.css"])),X=c(()=>u(()=>import("./title.8a8d449e.js"),["assets/title.8a8d449e.js","assets/index.a74f1f35.js","assets/index.1ce94655.css"])),Y={components:{Stage:M,StageRouteView:G,ValidationView:H,ActionFormView:K,FlowType:Q,Tag:W,Title:X},props:["flowid"],setup(p){const o=O({}),_=y(),e=L(()=>_.getters["flowchart/flowchart"]),I=L(()=>_.getters["stage/list"]),n=B({activeIndex:"0",formData:null,loadingStage:!0,stages:[]}),f=r=>new Promise((g,V)=>{var F=D(r);n.stages.push(F),g()}),s=r=>{var g=n.stages.length;g===1||n.stages.splice(r,1)},v=(r,g)=>{if(r==="add"){var V=n.stages.length;r=V+1,f(r).then(()=>{n.activeIndex=r-1})}else r==="delete"?(r=n.activeIndex=="0"?"0":parseInt(n.activeIndex),s(parseInt(n.activeIndex)),r==0?n.activeIndex=0:n.activeIndex=r-1):n.activeIndex=r},D=r=>({OrderId:r,StageName:"",StageRouteList:[],ActionFormList:[],ValidationList:[],StageJobList:[]});return q(async()=>{await _.dispatch("flowchart/getFlowchart",p.flowid),n.formData={...e.value},n.loadingStage=!0,await _.dispatch("stage/getList",p.flowid),n.stages=[...I.value],n.loadingStage=!1,await _.dispatch("actionClass/getList")}),{refForm:o,state:n,addStage:f,handleSelect:v}}},Z=A("i",{class:"el-icon-plus"},"+",-1),$=A("i",{class:"el-icon-delete"},"-",-1),ee={key:1};function te(p,o,_,e,I,n){const f=d("el-input"),s=d("el-form-item"),v=d("FlowType"),D=d("Tag"),r=d("Title"),g=d("el-checkbox"),V=d("el-menu-item"),F=d("el-menu"),E=d("StageRouteView"),U=d("ActionFormView"),h=d("ValidationView"),R=d("Stage"),S=d("el-card"),C=d("el-form");return m(),T(b,null,[P(p.$slots,"function",{form:e.refForm,data:e.state.formData,stages:e.state.stages}),e.state.formData?(m(),w(S,{key:0},{header:l(()=>[x(" \u7DE8\u8F2F\u8868\u55AE ")]),default:l(()=>[a(C,{model:e.state,ref:"refForm"},{default:l(()=>[a(s,{label:"\u4F5C\u696D\u540D\u7A31",prop:"formData.FlowName",rules:{required:!0,message:"\u8ACB\u8F38\u5165\u4F5C\u696D\u540D\u7A31",trigger:"blur"}},{default:l(()=>[a(f,{modelValue:e.state.formData.FlowName,"onUpdate:modelValue":o[0]||(o[0]=t=>e.state.formData.FlowName=t),placeholder:"\u8ACB\u8F38\u5165\u4F5C\u696D\u540D\u7A31",clearable:""},null,8,["modelValue"])]),_:1}),a(s,{label:"\u4F5C\u696D\u82F1\u6587\u540D\u7A31",prop:"formData.FlowEname"},{default:l(()=>[a(f,{modelValue:e.state.formData.FlowEname,"onUpdate:modelValue":o[1]||(o[1]=t=>e.state.formData.FlowEname=t),placeholder:"\u8ACB\u8F38\u5165\u4F5C\u696D\u82F1\u6587\u540D\u7A31",clearable:""},null,8,["modelValue"])]),_:1}),a(s,{label:"\u4F5C\u696D\u985E\u578B",prop:"formData.FlowType",rules:{required:!0,message:"\u8ACB\u9078\u64C7\u4F5C\u696D\u985E\u578B",trigger:"blur"}},{default:l(()=>[a(v,{modelValue:e.state.formData.FlowType,"onUpdate:modelValue":o[2]||(o[2]=t=>e.state.formData.FlowType=t),placeholder:"\u8ACB\u8F38\u5165\u985E\u578B",clearable:""},null,8,["modelValue"])]),_:1}),a(s,{label:"\u4F5C\u696D\u7BA1\u7406\u8005",prop:"formData.AdminUser",rules:{required:!0,message:"\u8ACB\u8F38\u5165\u4F5C\u696D\u7BA1\u7406\u8005",trigger:"blur"}},{default:l(()=>[a(f,{modelValue:e.state.formData.AdminUser,"onUpdate:modelValue":o[3]||(o[3]=t=>e.state.formData.AdminUser=t),placeholder:"\u8ACB\u8F38\u5165\u4F5C\u696D\u7BA1\u7406\u8005",clearable:""},null,8,["modelValue"])]),_:1}),a(s,{label:"Tag\u683C\u5F0F",prop:"formData.TagFormat",rules:{required:!0,message:"\u8ACB\u8F38\u5165Tag\u683C\u5F0F",trigger:"blur"}},{default:l(()=>[a(D,{modelValue:e.state.formData.TagFormat,"onUpdate:modelValue":o[4]||(o[4]=t=>e.state.formData.TagFormat=t)},null,8,["modelValue"])]),_:1}),a(s,{label:"Title\u683C\u5F0F",prop:"formData.TitleFormat",rules:{required:!0,message:"\u8ACB\u8F38\u5165Title\u683C\u5F0F",trigger:"blur"}},{default:l(()=>[a(r,{modelValue:e.state.formData.TitleFormat,"onUpdate:modelValue":o[5]||(o[5]=t=>e.state.formData.TitleFormat=t)},null,8,["modelValue"])]),_:1}),a(s,{label:"\u95DC\u9589\u4F7F\u7528",prop:"formData.Close"},{default:l(()=>[a(g,{modelValue:e.state.formData.Close,"onUpdate:modelValue":o[6]||(o[6]=t=>e.state.formData.Close=t)},null,8,["modelValue"])]),_:1},8,["prop"]),a(S,null,{header:l(()=>[x(" \u968E\u6BB5 ")]),default:l(()=>[a(F,{"default-active":e.state.activeIndex+"",mode:"horizontal",onSelect:e.handleSelect,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},{default:l(()=>[(m(!0),T(b,null,k(e.state.stages,(t,i)=>(m(),w(V,{index:i+"",key:i},{default:l(()=>[x(z(parseInt(i)+1),1)]),_:2},1032,["index"]))),128)),a(V,{index:"add"},{default:l(()=>[Z]),_:1}),a(V,{index:"delete"},{default:l(()=>[$]),_:1})]),_:1},8,["default-active","onSelect"]),(m(),w(j,{key:e.state.activeIndex},{default:l(()=>[!e.state.loadingStage&&e.state.activeIndex!="delete"?(m(),w(R,{key:0,modelValue:e.state.stages[e.state.activeIndex],"onUpdate:modelValue":o[7]||(o[7]=t=>e.state.stages[e.state.activeIndex]=t),index:e.state.activeIndex},{footer:l(t=>[a(E,{modelValue:t.stage.StageRouteList,"onUpdate:modelValue":i=>t.stage.StageRouteList=i},null,8,["modelValue","onUpdate:modelValue"]),a(U,{modelValue:t.stage.ActionFormList,"onUpdate:modelValue":i=>t.stage.ActionFormList=i},null,8,["modelValue","onUpdate:modelValue"]),a(h,{modelValue:t.stage.ValidationList,"onUpdate:modelValue":i=>t.stage.ValidationList=i},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["modelValue","index"])):(m(),T("div",ee,"\u522A\u9664\u6210\u529F"))]),_:1}))]),_:1})]),_:1},8,["model"])]),_:1})):J("",!0)],64)}const oe=N(Y,[["render",te]]);export{oe as F};
